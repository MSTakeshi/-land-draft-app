(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5520:function(e,t,o){Promise.resolve().then(o.bind(o,2011))},2011:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return a}});var s=o(7437),r=o(2265),n=o(5475);function a(){let e=(0,n.useRouter)(),[t,o]=(0,r.useState)(""),[a,i]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(0);(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("http://localhost:8000/voters/count");if(e.ok){let t=await e.json();h(t)}}catch(e){console.error("Failed to fetch voters count:",e)}};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]);let f=async e=>{e.preventDefault();try{let e=await fetch("http://localhost:8000/voters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,choice1:parseInt(a),choice2:parseInt(l),choice3:parseInt(d)})});if(!e.ok){let t=await e.json();throw Error(t.detail||"投票者の登録に失敗しました")}alert("投票者の登録が完了しました！"),o(""),i(""),c(""),u("");let s=await fetch("http://localhost:8000/voters/count");if(s.ok){let e=await s.json();h(e)}}catch(e){alert(e.message)}},x=async()=>{try{let t=await fetch("http://localhost:8000/draft/run",{method:"POST"});if(!t.ok){let e=await t.json();throw Error(e.detail||"ドラフトの実行に失敗しました")}alert("ドラフトの実行が完了しました！"),e.push("/results/1")}catch(e){alert(e.message)}};return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:[(0,s.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"XANA DAO Village 土地抽選会"}),(0,s.jsxs)("p",{className:"text-center text-lg mb-4",children:["現在の登録者数: ",m," / 10"]}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"投票者名（ニックネーム）"}),(0,s.jsx)("input",{type:"text",id:"name",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:t,onChange:e=>o(e.target.value),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"choice1",className:"block text-sm font-medium text-gray-700",children:"第1希望候補地 (1-32)"}),(0,s.jsx)("input",{type:"number",id:"choice1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:a,onChange:e=>i(e.target.value),min:"1",max:"32",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"choice2",className:"block text-sm font-medium text-gray-700",children:"第2希望候補地 (1-32)"}),(0,s.jsx)("input",{type:"number",id:"choice2",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:l,onChange:e=>c(e.target.value),min:"1",max:"32",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"choice3",className:"block text-sm font-medium text-gray-700",children:"第3希望候補地 (1-32)"}),(0,s.jsx)("input",{type:"number",id:"choice3",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:d,onChange:e=>u(e.target.value),min:"1",max:"32",required:!0})]}),(0,s.jsx)("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"投票者を登録する"})]})]}),m>=10&&(0,s.jsx)("button",{onClick:x,className:"mt-4 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"ドラフトを実行してラウンド1の結果を見る"})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5520)}),_N_E=e.O()}]);